<html><head>
    <title>{{language}} Keyboard to Keyman</title>

    <script src="/js/utils.js"></script>
    <style>
    textarea {
        width: 600px;
        height: 600px;
        border: 3px solid #cccccc;
        padding: 5px;
        font-size: 12px;
        font-variant-ligatures: normal;
        resize: vertical;
        font-family: "Courier New";
    }
    </style>
    <script>
    // TESTING
    var loaded_layout = '';
    function layout_info(x) {
      layout_loaded = x;
    }

    var k = { loadme: Object};
    k.loadme.prototype = function(a) {
      return a;
    }
    var e = {keyboard: k};

    var google = {elements: e};
    //google.elements = ''

     google.elements.keyboard.loadme.prototype = layout_info;

     //google.elements.keyboard.loadme.prototype = function(a) {
//      return a;
     //};
    </script>
    <script src="/layouts/en.js"></script>
    <script src="/layouts/{{kb_js}}.js"></script>
    <script src="/js/kmexport/kmexport.js"></script>
<script>

  function getMobileOptions() {
      // TODO: get controls
      return {};
  }

  function onPageLoaded() {
    //let LOAD_NAME = {{kb_js}}.google.elements.keyboard.loadme();
    // Compute mobile first because T_ constants are created there.
    let layout = {{kb_js}};
    const doMobile = true;
    const outputTransforms = null;
    const mobileOptions = getMobileOptions();
    const mobileResults = map_en_to_x(
	layout, false, doMobile, outputTransforms, mobileOptions);

    let kbResults = map_en_to_x(layout);

    let output = document.getElementById('output');
    output.innerHTML = kbResults;
    
    output = document.getElementById('touch_output');

    output.innerHTML = mobileResults;
}

</script>
</head>

  <body onload="onPageLoaded()">
  <h1>Load keyboard</h1>
  <textarea id="output"></textarea>
  <h1>Mobile touch</h1>
  <textarea id="touch_output"></textarea>
</body>
</html>
